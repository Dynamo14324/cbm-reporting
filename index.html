<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vibration Analysis Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.1/moment.min.js"></script>
    <style>
        .dropzone {
            border: 2px dashed #3b82f6;
            transition: all 0.3s;
        }
        .dropzone.active {
            background-color: #f0f9ff;
            border-color: #2563eb;
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 6px;
        }
        .status-good { background-color: #10b981; }
        .status-warning { background-color: #f59e0b; }
        .status-critical { background-color: #ef4444; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        #toast {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s;
        }
        #toast.show { opacity: 1; }
        .chart-container {
            position: relative;
            height: 400px;
            width: 100%;
        }
        @media (max-width: 768px) {
            .chart-container {
                height: 300px;
            }
            .filter-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Toast Notification -->
    <div id="toast" class="bg-green-500 text-white px-6 py-3 rounded shadow-lg">
        <span id="toast-message">Success!</span>
    </div>

    <div class="container mx-auto px-4 py-6">
        <!-- Header -->
        <header class="bg-blue-800 text-white p-4 rounded-t-lg">
            <h1 class="text-2xl font-bold">Vibration Analysis Dashboard</h1>
            <p class="text-blue-200">Comprehensive equipment monitoring system</p>
        </header>

        <!-- Tabs -->
        <div class="flex border-b border-gray-200 bg-white overflow-x-auto">
            <button class="tab-btn py-4 px-6 font-medium border-b-2 border-blue-800 text-blue-800 whitespace-nowrap" data-tab="upload">Data Upload</button>
            <button class="tab-btn py-4 px-6 font-medium text-gray-500 whitespace-nowrap" data-tab="equipment">Equipment Analysis</button>
            <button class="tab-btn py-4 px-6 font-medium text-gray-500 whitespace-nowrap" data-tab="trend">Trend Analysis</button>
            <button class="tab-btn py-4 px-6 font-medium text-gray-500 whitespace-nowrap" data-tab="raw">Raw Data</button>
            <button class="tab-btn py-4 px-6 font-medium text-gray-500 whitespace-nowrap" data-tab="missing">Missing Readings</button>
        </div>

        <!-- Upload Tab -->
        <div id="upload" class="tab-content active bg-white p-6 rounded-b-lg shadow">
            <div id="dropzone" class="dropzone rounded-lg p-12 text-center cursor-pointer mb-6">
                <div class="flex flex-col items-center justify-center">
                    <svg class="w-12 h-12 text-blue-500 mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                    </svg>
                    <h3 class="text-lg font-medium text-gray-700">Drag & drop files here</h3>
                    <p class="text-gray-500 mt-1">or click to browse files</p>
                    <input type="file" id="file-input" class="hidden" accept=".xlsx,.xls,.csv" multiple>
                </div>
            </div>
            
            <div class="mb-6">
                <h3 class="font-medium text-gray-700 mb-3">Processing Options</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <label class="flex items-center">
                        <input type="checkbox" class="form-checkbox h-5 w-5 text-blue-600" checked id="process-vibration">
                        <span class="ml-2 text-gray-700">Process vibration data</span>
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="form-checkbox h-5 w-5 text-blue-600" checked id="process-rpm">
                        <span class="ml-2 text-gray-700">Include RPM analysis</span>
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" class="form-checkbox h-5 w-5 text-blue-600" checked id="process-ampere">
                        <span class="ml-2 text-gray-700">Include ampere analysis</span>
                    </label>
                </div>
            </div>
            
            <button id="process-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-lg flex items-center">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                </svg>
                Process Files
            </button>
            
            <div id="file-preview" class="mt-8">
                <h3 class="font-medium text-gray-700 mb-3">Uploaded Files</h3>
                <div id="file-list" class="border rounded-lg divide-y">
                    <div class="text-gray-500 p-4 text-center">No files uploaded yet</div>
                </div>
            </div>
            
            <div id="processing-results" class="mt-8 hidden">
                <div class="bg-blue-50 rounded-lg p-4 mb-4">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="bg-white rounded-lg p-3 shadow-sm">
                            <div class="text-sm text-gray-500">Files Processed</div>
                            <div class="text-xl font-semibold text-blue-800" id="processed-files">0</div>
                        </div>
                        <div class="bg-white rounded-lg p-3 shadow-sm">
                            <div class="text-sm text-gray-500">Records Added</div>
                            <div class="text-xl font-semibold text-blue-800" id="processed-records">0</div>
                        </div>
                        <div class="bg-white rounded-lg p-3 shadow-sm">
                            <div class="text-sm text-gray-500">Processing Time</div>
                            <div class="text-xl font-semibold text-blue-800" id="processing-time">0s</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Equipment Analysis Tab -->
        <div id="equipment" class="tab-content bg-white p-6 rounded-b-lg shadow">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6 filter-grid">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Vessel</label>
                    <select id="equipment-vessel" class="w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        <option value="">Select Vessel</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Equipment Code</label>
                    <select id="equipment-code" class="w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        <option value="">Select Code</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Component</label>
                    <select id="equipment-component" class="w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        <option value="">Select Component</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Parameter</label>
                    <select id="equipment-parameter" class="w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        <option value="Vel, Rms (RMS)">Vibration Velocity</option>
                        <option value="Disp, Rms (RMS)">Vibration Displacement</option>
                        <option value="Acc, Rms (RMS)">Vibration Acceleration</option>
                        <option value="RPM1">RPM</option>
                        <option value="ALT_1">Ampere</option>
                    </select>
                </div>
            </div>
            
            <button id="export-equipment-btn" class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg flex items-center mb-6">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                </svg>
                Export Data
            </button>
            
            <div id="equipment-preview" class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white rounded-lg shadow-sm p-4 border border-gray-100">
                    <h3 class="font-medium text-gray-700 mb-3">Parameter Trend</h3>
                    <div class="chart-container">
                        <canvas id="equipment-trend-chart"></canvas>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-sm p-4 border border-gray-100">
                    <h3 class="font-medium text-gray-700 mb-3">RPM vs Ampere</h3>
                    <div class="chart-container">
                        <canvas id="rpm-ampere-chart"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="mt-6">
                <h3 class="font-medium text-gray-700 mb-3">Recent Readings</h3>
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white border rounded-lg">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Timestamp</th>
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Equipment Code</th>
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Component</th>
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Parameter</th>
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Value</th>
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                            </tr>
                        </thead>
                        <tbody id="equipment-readings" class="divide-y">
                            <tr>
                                <td colspan="6" class="px-4 py-4 text-center text-gray-500">No data available</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Trend Analysis Tab -->
        <div id="trend" class="tab-content bg-white p-6 rounded-b-lg shadow">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 filter-grid">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Parameter</label>
                    <select id="trend-parameter" class="w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        <option value="Vel, Rms (RMS)">Vibration Velocity</option>
                        <option value="Disp, Rms (RMS)">Vibration Displacement</option>
                        <option value="Acc, Rms (RMS)">Vibration Acceleration</option>
                        <option value="RPM1">RPM</option>
                        <option value="ALT_1">Ampere</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Vessel</label>
                    <select id="trend-vessel" class="w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        <option value="">All Vessels</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Time Range</label>
                    <select id="trend-range" class="w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        <option value="7">Last 7 days</option>
                        <option value="30">Last 30 days</option>
                        <option value="90">Last 90 days</option>
                        <option value="0">All data</option>
                    </select>
                </div>
            </div>
            
            <button id="export-trend-btn" class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg flex items-center mb-6">
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                </svg>
                Export Trend Data
            </button>
            
            <div class="bg-white rounded-lg shadow-sm p-4 border border-gray-100 mb-6">
                <h3 class="font-medium text-gray-700 mb-3">Parameter Trend</h3>
                <div class="chart-container">
                    <canvas id="trend-chart"></canvas>
                </div>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div class="bg-white rounded-lg shadow-sm p-3 border border-gray-100">
                    <div class="text-sm text-gray-500">Average</div>
                    <div class="text-xl font-semibold" id="trend-average">-</div>
                </div>
                <div class="bg-white rounded-lg shadow-sm p-3 border border-gray-100">
                    <div class="text-sm text-gray-500">Minimum</div>
                    <div class="text-xl font-semibold" id="trend-minimum">-</div>
                </div>
                <div class="bg-white rounded-lg shadow-sm p-3 border border-gray-100">
                    <div class="text-sm text-gray-500">Maximum</div>
                    <div class="text-xl font-semibold" id="trend-maximum">-</div>
                </div>
                <div class="bg-white rounded-lg shadow-sm p-3 border border-gray-100">
                    <div class="text-sm text-gray-500">Standard Deviation</div>
                    <div class="text-xl font-semibold" id="trend-stddev">-</div>
                </div>
            </div>
        </div>

        <!-- Raw Data Tab -->
        <div id="raw" class="tab-content bg-white p-6 rounded-b-lg shadow">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4 gap-4">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 w-full">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Vessel</label>
                        <select id="raw-vessel" class="w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                            <option value="">All Vessels</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Parameter</label>
                        <select id="raw-parameter" class="w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                            <option value="">All Parameters</option>
                            <option value="Vel, Rms (RMS)">Vibration Velocity</option>
                            <option value="Disp, Rms (RMS)">Vibration Displacement</option>
                            <option value="Acc, Rms (RMS)">Vibration Acceleration</option>
                            <option value="RPM1">RPM</option>
                            <option value="ALT_1">Ampere</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Time Range</label>
                        <select id="raw-range" class="w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                            <option value="0">All Data</option>
                            <option value="7">Last 7 Days</option>
                            <option value="30">Last 30 Days</option>
                            <option value="90">Last 90 Days</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Search</label>
                        <input type="text" id="raw-search" class="w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500" placeholder="Search...">
                    </div>
                </div>
                <button id="export-raw-btn" class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg flex items-center whitespace-nowrap">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                    </svg>
                    Export Data
                </button>
            </div>
            
            <div class="overflow-x-auto">
                <table class="min-w-full bg-white border rounded-lg">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Timestamp</th>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Vessel</th>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Equipment Code</th>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Component</th>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Parameter</th>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Value</th>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                        </tr>
                    </thead>
                    <tbody id="raw-data-body" class="divide-y">
                        <tr>
                            <td colspan="7" class="px-4 py-4 text-center text-gray-500">No data available</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="flex items-center justify-between mt-4">
                <div class="text-sm text-gray-500">Showing <span id="raw-data-showing">0-0</span> of <span id="raw-data-total">0</span> records</div>
                <div class="flex space-x-2">
                    <button id="raw-prev-page" class="p-2 border rounded-md disabled:opacity-50" disabled>
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                        </svg>
                    </button>
                    <button id="raw-next-page" class="p-2 border rounded-md disabled:opacity-50" disabled>
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Missing Equipment Tab -->
        <div id="missing" class="tab-content bg-white p-6 rounded-b-lg shadow">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 filter-grid">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Vessel</label>
                    <select id="missing-vessel" class="w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        <option value="">All Vessels</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Days Threshold</label>
                    <select id="missing-threshold" class="w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        <option value="30">30 days</option>
                        <option value="60">60 days</option>
                        <option value="90">90 days</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Sort By</label>
                    <select id="missing-sort" class="w-full border-gray-300 rounded-md shadow-sm focus:border-blue-500 focus:ring-blue-500">
                        <option value="days">Days Since Last Reading</option>
                        <option value="equipment">Equipment Code</option>
                        <option value="component">Component Name</option>
                    </select>
                </div>
            </div>
            
            <div class="bg-blue-50 rounded-lg p-4 mb-6">
                <div class="text-sm text-gray-700" id="missing-summary">
                    Select a vessel and threshold to see equipment missing readings.
                </div>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <div class="bg-white rounded-lg shadow-sm p-4 border border-gray-100">
                    <h3 class="font-medium text-gray-700 mb-3">Equipment Reading Status</h3>
                    <div class="chart-container">
                        <canvas id="missing-equipment-chart"></canvas>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-sm p-4 border border-gray-100">
                    <h3 class="font-medium text-gray-700 mb-3">Days Since Last Reading</h3>
                    <div class="chart-container">
                        <canvas id="days-since-reading-chart"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="mt-6">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-medium text-gray-700">Equipment Missing Readings</h3>
                    <button id="export-missing-btn" class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg flex items-center">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                        </svg>
                        Export Report
                    </button>
                </div>
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white border rounded-lg">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Equipment Code</th>
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Component</th>
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Vessel</th>
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Last Reading</th>
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Days Since</th>
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Status</th>
                                <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="missing-equipment-list" class="divide-y">
                            <tr>
                                <td colspan="7" class="px-4 py-4 text-center text-gray-500">No data available</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Main Application Class
        class VibrationAnalysisApp {
            constructor() {
                this.state = {
                    files: [],
                    rawData: [],
                    vessels: new Set(),
                    equipmentCodes: new Set(),
                    components: new Set(),
                    charts: {},
                    currentPage: 1,
                    rowsPerPage: 20
                };

                this.initElements();
                this.setupEventListeners();
            }

            // Initialize DOM elements
            initElements() {
                // DOM Elements
                this.tabBtns = document.querySelectorAll('.tab-btn');
                this.tabContents = document.querySelectorAll('.tab-content');
                this.dropzone = document.getElementById('dropzone');
                this.fileInput = document.getElementById('file-input');
                this.fileList = document.getElementById('file-list');
                this.processBtn = document.getElementById('process-btn');
                
                // Toast
                this.toast = document.getElementById('toast');
                this.toastMessage = document.getElementById('toast-message');
            }

            // Set up event listeners
            setupEventListeners() {
                // Tab navigation
                this.tabBtns.forEach(btn => {
                    btn.addEventListener('click', () => this.switchTab(btn.dataset.tab));
                });

                // File upload
                this.dropzone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    this.dropzone.classList.add('active');
                });

                this.dropzone.addEventListener('dragleave', () => {
                    this.dropzone.classList.remove('active');
                });

                this.dropzone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    this.dropzone.classList.remove('active');
                    if (e.dataTransfer.files.length) {
                        this.fileInput.files = e.dataTransfer.files;
                        this.updateFileList();
                    }
                });

                this.dropzone.addEventListener('click', () => this.fileInput.click());
                this.fileInput.addEventListener('change', () => this.updateFileList());

                // Process button
                this.processBtn.addEventListener('click', () => this.processFiles());
                
                // Pagination
                document.getElementById('raw-prev-page').addEventListener('click', () => this.prevPage());
                document.getElementById('raw-next-page').addEventListener('click', () => this.nextPage());
                
                // Search and filters
                document.getElementById('raw-search').addEventListener('input', () => this.updateRawDataTable());
                document.getElementById('raw-vessel').addEventListener('change', () => this.updateRawDataTable());
                document.getElementById('raw-parameter').addEventListener('change', () => this.updateRawDataTable());
                document.getElementById('raw-range').addEventListener('change', () => this.updateRawDataTable());
                
                // Trend analysis filters
                document.getElementById('trend-vessel').addEventListener('change', () => this.updateTrendChart());
                document.getElementById('trend-parameter').addEventListener('change', () => this.updateTrendChart());
                document.getElementById('trend-range').addEventListener('change', () => this.updateTrendChart());
                
                // Equipment analysis filters
                document.getElementById('equipment-vessel').addEventListener('change', () => this.updateEquipmentFilters());
                document.getElementById('equipment-code').addEventListener('change', () => this.updateEquipmentFilters());
                document.getElementById('equipment-component').addEventListener('change', () => this.updateEquipmentAnalysis());
                document.getElementById('equipment-parameter').addEventListener('change', () => this.updateEquipmentAnalysis());
                
                // Missing equipment filters
                document.getElementById('missing-vessel').addEventListener('change', () => this.refreshMissingEquipmentData());
                document.getElementById('missing-threshold').addEventListener('change', () => this.refreshMissingEquipmentData());
                document.getElementById('missing-sort').addEventListener('change', () => this.refreshMissingEquipmentData());
                
                // Export buttons
                document.getElementById('export-equipment-btn').addEventListener('click', () => this.exportEquipmentData());
                document.getElementById('export-trend-btn').addEventListener('click', () => this.exportTrendData());
                document.getElementById('export-raw-btn').addEventListener('click', () => this.exportRawData());
                document.getElementById('export-missing-btn').addEventListener('click', () => this.exportMissingEquipmentReport());
            }

            // Switch between tabs
            switchTab(tabId) {
                // Remove active class from all tabs and content
                this.tabBtns.forEach(btn => {
                    btn.classList.remove('border-b-2', 'border-blue-800', 'text-blue-800');
                    btn.classList.add('text-gray-500');
                });
                
                this.tabContents.forEach(content => {
                    content.classList.remove('active');
                });
                
                // Add active class to clicked tab
                const activeBtn = document.querySelector(`.tab-btn[data-tab="${tabId}"]`);
                if (activeBtn) {
                    activeBtn.classList.remove('text-gray-500');
                    activeBtn.classList.add('border-b-2', 'border-blue-800', 'text-blue-800');
                }
                
                // Show corresponding content
                document.getElementById(tabId).classList.add('active');
                
                // Initialize tab-specific content if needed
                if (tabId === 'equipment' && this.state.rawData.length > 0) {
                    this.updateEquipmentFilters();
                } else if (tabId === 'trend' && this.state.rawData.length > 0) {
                    this.updateTrendChart();
                } else if (tabId === 'raw' && this.state.rawData.length > 0) {
                    this.updateRawDataTable();
                } else if (tabId === 'missing' && this.state.rawData.length > 0) {
                    this.refreshMissingEquipmentData();
                }
            }

            // Update file list after selection
            updateFileList() {
                this.fileList.innerHTML = '';
                this.state.files = Array.from(this.fileInput.files);

                if (this.state.files.length === 0) {
                    this.fileList.innerHTML = '<div class="text-gray-500 p-4 text-center">No files uploaded yet</div>';
                    this.processBtn.disabled = true;
                    return;
                }

                this.state.files.forEach(file => {
                    const fileItem = document.createElement('div');
                    fileItem.className = 'flex items-center justify-between p-4';
                    fileItem.innerHTML = `
                        <div class="flex items-center">
                            <svg class="w-6 h-6 text-blue-500 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <div>
                                <div class="font-medium">${file.name}</div>
                                <div class="text-sm text-gray-500">${this.formatFileSize(file.size)}</div>
                            </div>
                        </div>
                        <div class="text-sm text-blue-500">Ready</div>
                    `;
                    this.fileList.appendChild(fileItem);
                });

                this.processBtn.disabled = false;
            }

            // Format file size for display
            formatFileSize(bytes) {
                if (bytes < 1024) return bytes + ' bytes';
                if (bytes < 1048576) return (bytes / 1024).toFixed(1) + ' KB';
                return (bytes / 1048576).toFixed(1) + ' MB';
            }

            // Process uploaded files
            async processFiles() {
                if (this.state.files.length === 0) {
                    this.showToast('No files to process', 'error');
                    return;
                }

                this.processBtn.disabled = true;
                this.processBtn.innerHTML = `
                    <svg class="animate-spin -ml-1 mr-2 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    Processing...
                `;

                // Show processing indicator
                document.getElementById('processing-results').classList.remove('hidden');
                document.getElementById('processed-files').textContent = '0';
                document.getElementById('processed-records').textContent = '0';
                
                const startTime = performance.now();
                let totalRecords = 0;
                let processedFiles = 0;
                
                // Initialize combined data array
                this.state.rawData = [];
                this.state.vessels = new Set();
                this.state.equipmentCodes = new Set();
                this.state.components = new Set();
                
                // Process each file
                const processNextFile = (index) => {
                    if (index >= this.state.files.length) {
                        // All files processed
                        const endTime = performance.now();
                        const processingTime = ((endTime - startTime) / 1000).toFixed(2);
                        
                        // Update UI
                        document.getElementById('processing-time').textContent = `${processingTime}s`;
                        
                        // Initialize analysis tabs
                        this.initializeAnalysisTabs();
                        this.showToast(`Processed ${this.state.rawData.length} records from ${this.state.files.length} vessels successfully`);
                        
                        // Switch to Equipment Analysis tab
                        this.switchTab('equipment');
                        
                        this.processBtn.disabled = false;
                        this.processBtn.innerHTML = `
                            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                            </svg>
                            Process Files
                        `;
                        return;
                    }
                    
                    const file = this.state.files[index];
                    const reader = new FileReader();
                    
                    reader.onload = (e) => {
                        try {
                            // Extract vessel name from filename (remove extension)
                            const vesselName = file.name.replace(/\.[^/.]+$/, "");
                            this.state.vessels.add(vesselName);
                            
                            // Parse file based on type
                            let data;
                            if (file.name.endsWith('.csv')) {
                                data = this.parseCSV(e.target.result);
                            } else {
                                const arrayBuffer = e.target.result;
                                const data = new Uint8Array(arrayBuffer);
                                const workbook = XLSX.read(data, { type: 'array' });
                                const worksheet = workbook.Sheets[workbook.SheetNames[0]];
                                data = XLSX.utils.sheet_to_json(worksheet);
                            }
                            
                            // Process data
                            const parsedData = this.parseData(data, vesselName);
                            
                            // Add to combined data
                            this.state.rawData = this.state.rawData.concat(parsedData);
                            
                            // Update counters
                            totalRecords += parsedData.length;
                            processedFiles++;
                            
                            // Update UI
                            document.getElementById('processed-files').textContent = processedFiles;
                            document.getElementById('processed-records').textContent = totalRecords;
                            
                            // Update file list item
                            const fileItems = this.fileList.querySelectorAll('div.flex');
                            if (fileItems[index]) {
                                const statusElement = fileItems[index].querySelector('.text-sm.text-blue-500');
                                if (statusElement) {
                                    statusElement.textContent = 'Processed';
                                    statusElement.className = 'text-sm text-green-500';
                                }
                            }
                            
                            // Process next file
                            processNextFile(index + 1);
                        } catch (error) {
                            console.error('Error processing file:', error);
                            this.showToast(`Error processing file ${file.name}: ${error.message}`, 'error');
                            
                            // Update file list item to show error
                            const fileItems = this.fileList.querySelectorAll('div.flex');
                            if (fileItems[index]) {
                                const statusElement = fileItems[index].querySelector('.text-sm.text-blue-500');
                                if (statusElement) {
                                    statusElement.textContent = 'Error';
                                    statusElement.className = 'text-sm text-red-500';
                                }
                            }
                            
                            // Continue with next file
                            processNextFile(index + 1);
                        }
                    };
                    
                    reader.onerror = () => {
                        console.error('Error reading file:', file.name);
                        this.showToast(`Error reading file ${file.name}`, 'error');
                        
                        // Update file list item to show error
                        const fileItems = this.fileList.querySelectorAll('div.flex');
                        if (fileItems[index]) {
                            const statusElement = fileItems[index].querySelector('.text-sm.text-blue-500');
                            if (statusElement) {
                                statusElement.textContent = 'Error';
                                statusClass = 'text-sm text-red-500';
                            }
                        }
                        
                        // Continue with next file
                        processNextFile(index + 1);
                    };
                    
                    // Read file as array buffer for Excel files, text for CSV
                    if (file.name.endsWith('.csv')) {
                        reader.readAsText(file);
                    } else {
                        reader.readAsArrayBuffer(file);
                    }
                };
                
                // Start processing files
                processNextFile(0);
            }

            // Parse CSV data
            parseCSV(csvText) {
                const lines = csvText.split('\n');
                const headers = lines[0].split(',').map(h => h.trim());
                const result = [];
                
                for (let i = 1; i < lines.length; i++) {
                    if (!lines[i].trim()) continue;
                    
                    const values = lines[i].split(',');
                    const row = {};
                    
                    for (let j = 0; j < headers.length; j++) {
                        row[headers[j]] = values[j];
                    }
                    
                    result.push(row);
                }
                
                return result;
            }

            // Parse data from file
            parseData(data, vesselName) {
                const parsedData = [];
                
                data.forEach(row => {
                    // Create proper timestamp from DATE and TIME columns
                    let timestamp;
                    if (row.DATE !== undefined && row.TIME !== undefined) {
                        timestamp = this.formatTimestamp(row.DATE, row.TIME);
                    } else if (row.TIMESTAMP !== undefined) {
                        timestamp = this.formatTimestamp(row.TIMESTAMP);
                    } else {
                        timestamp = new Date().toISOString();
                    }
                    
                    // Extract equipment code and component name
                    const equipmentCode = row.MP_NUMBER || '';
                    const component = row.COMP_NAME || '';
                    
                    // Add to sets for filtering
                    if (equipmentCode) this.state.equipmentCodes.add(equipmentCode);
                    if (component) this.state.components.add(component);
                    
                    // Create a clean data object with all relevant fields
                    const cleanRow = {
                        VESSEL: vesselName,
                        EQUIPMENT_CODE: equipmentCode,
                        MP_NUMBER: equipmentCode,
                        COMP_NAME: component,
                        TIMESTAMP: timestamp,
                        DATE: row.DATE,
                        TIME: row.TIME,
                        'Vel, Rms (RMS)': parseFloat(row['Vel, Rms (RMS)']) || 0,
                        'Disp, Rms (RMS)': parseFloat(row['Disp, Rms (RMS)']) || 0,
                        'Acc, Rms (RMS)': parseFloat(row['Acc, Rms (RMS)']) || 0,
                        RPM1: parseFloat(row.RPM1) || 0,
                        ALT_1: parseFloat(row.ALT_1) || 0
                    };
                    
                    parsedData.push(cleanRow);
                });
                
                return parsedData;
            }

            // Format timestamp
            formatTimestamp(date, time) {
                // Handle Excel numeric date format
                if (typeof date === 'number') {
                    // Excel dates are number of days since 1900-01-01
                    const excelEpoch = new Date(1900, 0, 1);
                    const dateObj = new Date(excelEpoch.getTime() + (date - 1) * 24 * 60 * 60 * 1000);
                    
                    // Add time component if available
                    if (typeof time === 'number') {
                        // Excel time is fraction of day
                        const millisInDay = 24 * 60 * 60 * 1000;
                        dateObj.setTime(dateObj.getTime() + time * millisInDay);
                    }
                    
                    return dateObj.toISOString();
                }
                
                // Handle date object
                if (date instanceof Date) {
                    return date.toISOString();
                }
                
                // If date is a string, try to parse it
                if (typeof date === 'string') {
                    try {
                        // Try ISO format first
                        if (date.includes('T')) {
                            return new Date(date).toISOString();
                        }
                        
                        // Try dd/mm/yyyy format
                        if (date.includes('/')) {
                            const [day, month, year] = date.split('/');
                            const dateObj = new Date(`${year}-${month}-${day}`);
                            if (time) {
                                const [hours, minutes, seconds] = time.split(':');
                                dateObj.setHours(hours || 0, minutes || 0, seconds || 0);
                            }
                            return dateObj.toISOString();
                        }
                        
                        // Try other formats
                        return new Date(date).toISOString();
                    } catch (e) {
                        console.error('Error parsing date string:', e);
                    }
                }
                
                // Return current date if we can't parse
                return new Date().toISOString();
            }
            
            // Format timestamp for display
            formatDisplayTimestamp(timestamp) {
                if (!timestamp) return '';
                
                const date = new Date(timestamp);
                if (isNaN(date.getTime())) return timestamp;
                
                const day = String(date.getDate()).padStart(2, '0');
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const year = date.getFullYear();
                const hours = String(date.getHours()).padStart(2, '0');
                const minutes = String(date.getMinutes()).padStart(2, '0');
                const seconds = String(date.getSeconds()).padStart(2, '0');
                
                return `${day}/${month}/${year} ${hours}:${minutes}:${seconds}`;
            }
            
            // Initialize analysis tabs
            initializeAnalysisTabs() {
                // Populate vessel dropdowns in all tabs
                this.populateDropdown('equipment-vessel', this.state.vessels);
                this.populateDropdown('trend-vessel', this.state.vessels, true);
                this.populateDropdown('raw-vessel', this.state.vessels, true);
                this.populateDropdown('missing-vessel', this.state.vessels, true);
                
                // Initialize equipment filters
                this.updateEquipmentFilters();
                
                // Initialize trend analysis
                this.updateTrendChart();
            }
            
            // Populate dropdown with options
            populateDropdown(dropdownId, items, includeAll = false) {
                const dropdown = document.getElementById(dropdownId);
                dropdown.innerHTML = '';
                
                // Add default option
                if (includeAll) {
                    const defaultOption = document.createElement('option');
                    defaultOption.value = '';
                    defaultOption.textContent = dropdownId.startsWith('missing') ? 'All Vessels' : 'Select';
                    dropdown.appendChild(defaultOption);
                }
                
                // Add items sorted
                Array.from(items).sort().forEach(item => {
                    const option = document.createElement('option');
                    option.value = item;
                    option.textContent = item;
                    dropdown.appendChild(option);
                });
            }
            
            // Update equipment filters
            updateEquipmentFilters() {
                const vessel = document.getElementById('equipment-vessel').value;
                
                // Clear existing options
                document.getElementById('equipment-code').innerHTML = '<option value="">Select Code</option>';
                document.getElementById('equipment-component').innerHTML = '<option value="">Select Component</option>';
                
                // Filter equipment codes based on vessel selection
                let filteredEquipment = new Set();
                let filteredComponents = new Set();
                
                this.state.rawData.forEach(row => {
                    if (!vessel || row.VESSEL === vessel) {
                        if (row.EQUIPMENT_CODE) filteredEquipment.add(row.EQUIPMENT_CODE);
                        if (row.COMP_NAME) filteredComponents.add(row.COMP_NAME);
                    }
                });
                
                // Populate equipment code dropdown
                this.populateDropdown('equipment-code', filteredEquipment);
                
                // Populate component dropdown if equipment is selected
                const equipment = document.getElementById('equipment-code').value;
                if (equipment) {
                    this.updateComponentFilter(vessel, equipment);
                }
                
                // Update analysis
                this.updateEquipmentAnalysis();
            }
            
            // Update component filter based on vessel and equipment selection
            updateComponentFilter(vessel, equipment) {
                const componentSelect = document.getElementById('equipment-component');
                componentSelect.innerHTML = '<option value="">Select Component</option>';
                
                // Filter components based on selections
                let filteredComponents = new Set();
                
                this.state.rawData.forEach(row => {
                    if ((!vessel || row.VESSEL === vessel) && 
                        row.EQUIPMENT_CODE === equipment && 
                        row.COMP_NAME) {
                        filteredComponents.add(row.COMP_NAME);
                    }
                });
                
                // Populate component dropdown
                this.populateDropdown('equipment-component', filteredComponents);
            }
            
            // Update equipment analysis
            updateEquipmentAnalysis() {
                const vessel = document.getElementById('equipment-vessel').value;
                const equipment = document.getElementById('equipment-code').value;
                const component = document.getElementById('equipment-component').value;
                const parameter = document.getElementById('equipment-parameter').value;
                
                // Filter data based on selections
                let filteredData = this.state.rawData.filter(row => {
                    return (!vessel || row.VESSEL === vessel) &&
                           (!equipment || row.EQUIPMENT_CODE === equipment) &&
                           (!component || row.COMP_NAME === component);
                });
                
                // Sort by timestamp
                filteredData.sort((a, b) => new Date(a.TIMESTAMP) - new Date(b.TIMESTAMP));
                
                // Update charts
                this.updateEquipmentChart(filteredData, parameter);
                
                // Update readings table
                this.updateEquipmentReadingsTable(filteredData, parameter);
            }
            
            // Update equipment chart
            updateEquipmentChart(data, parameter) {
                const ctx = document.getElementById('equipment-trend-chart').getContext('2d');
                
                // Prepare chart data
                const labels = data.map(row => this.formatDisplayTimestamp(row.TIMESTAMP));
                const values = data.map(row => row[parameter]);
                
                // Create or update chart
                if (this.state.charts.equipmentTrendChart) {
                    this.state.charts.equipmentTrendChart.data.labels = labels;
                    this.state.charts.equipmentTrendChart.data.datasets[0].data = values;
                    this.state.charts.equipmentTrendChart.update();
                } else {
                    this.state.charts.equipmentTrendChart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: parameter,
                                data: values,
                                borderColor: '#3b82f6',
                                backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                borderWidth: 2,
                                fill: true
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Timestamp'
                                    }
                                },
                                y: {
                                    title: {
                                        display: true,
                                        text: parameter
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Update RPM vs Ampere chart if data is available
                if (parameter === 'RPM1' || parameter === 'ALT_1') {
                    this.updateRpmAmpereChart(data);
                }
            }
            
            // Update RPM vs Ampere chart
            updateRpmAmpereChart(data) {
                const ctx = document.getElementById('rpm-ampere-chart').getContext('2d');
                
                // Prepare data points
                const rpmData = data.map(row => row.RPM1);
                const ampereData = data.map(row => row.ALT_1);
                const labels = data.map(row => this.formatDisplayTimestamp(row.TIMESTAMP));
                
                // Create or update chart
                if (this.state.charts.rpmAmpereChart) {
                    this.state.charts.rpmAmpereChart.data.labels = labels;
                    this.state.charts.rpmAmpereChart.data.datasets[0].data = rpmData;
                    this.state.charts.rpmAmpereChart.data.datasets[1].data = ampereData;
                    this.state.charts.rpmAmpereChart.update();
                } else {
                    this.state.charts.rpmAmpereChart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [
                                {
                                    label: 'RPM',
                                    data: rpmData,
                                    borderColor: '#3b82f6',
                                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                                    borderWidth: 2,
                                    yAxisID: 'y'
                                },
                                {
                                    label: 'Ampere',
                                    data: ampereData,
                                    borderColor: '#10b981',
                                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                                    borderWidth: 2,
                                    yAxisID: 'y1'
                                }
                            ]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Timestamp'
                                    }
                                },
                                y: {
                                    type: 'linear',
                                    display: true,
                                    position: 'left',
                                    title: {
                                        display: true,
                                        text: 'RPM'
                                    }
                                },
                                y1: {
                                    type: 'linear',
                                    display: true,
                                    position: 'right',
                                    title: {
                                        display: true,
                                        text: 'Ampere'
                                    },
                                    grid: {
                                        drawOnChartArea: false
                                    }
                                }
                            }
                        }
                    });
                }
            }
            
            // Update equipment readings table
            updateEquipmentReadingsTable(data, parameter) {
                const tableBody = document.getElementById('equipment-readings');
                tableBody.innerHTML = '';
                
                // Sort by timestamp (newest first)
                const sortedData = [...data].sort((a, b) => new Date(b.TIMESTAMP) - new Date(a.TIMESTAMP));
                
                // Show only the most recent 10 readings
                const recentData = sortedData.slice(0, 10);
                
                if (recentData.length === 0) {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="6" class="px-4 py-4 text-center text-gray-500">No data available</td>
                        </tr>
                    `;
                    return;
                }
                
                // Add rows to table
                recentData.forEach(row => {
                    const value = row[parameter];
                    let status, statusClass;
                    
                    // Determine status based on parameter value
                    if (parameter === 'Vel, Rms (RMS)') {
                        if (value > 7.1) {
                            status = 'Critical';
                            statusClass = 'status-critical';
                        } else if (value > 4.5) {
                            status = 'Warning';
                            statusClass = 'status-warning';
                        } else {
                            status = 'Normal';
                            statusClass = 'status-good';
                        }
                    } else {
                        status = 'Normal';
                        statusClass = 'status-good';
                    }
                    
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td class="px-4 py-2">${this.formatDisplayTimestamp(row.TIMESTAMP)}</td>
                        <td class="px-4 py-2">${row.EQUIPMENT_CODE}</td>
                        <td class="px-4 py-2">${row.COMP_NAME}</td>
                        <td class="px-4 py-2">${parameter}</td>
                        <td class="px-4 py-2">${value.toFixed(2)}</td>
                        <td class="px-4 py-2">
                            <span class="status-indicator ${statusClass}"></span>
                            ${status}
                        </td>
                    `;
                    tableBody.appendChild(tr);
                });
            }
            
            // Update trend chart
            updateTrendChart() {
                const parameter = document.getElementById('trend-parameter').value;
                const vessel = document.getElementById('trend-vessel').value;
                const days = parseInt(document.getElementById('trend-range').value);
                
                // Filter data based on selections
                let filteredData = this.state.rawData.filter(row => {
                    return (!vessel || row.VESSEL === vessel) && 
                           row[parameter] !== undefined;
                });
                
                // Apply time range filter
                if (days > 0) {
                    const cutoffDate = new Date();
                    cutoffDate.setDate(cutoffDate.getDate() - days);
                    
                    filteredData = filteredData.filter(row => {
                        return new Date(row.TIMESTAMP) >= cutoffDate;
                    });
                }
                
                // Group data by component for the chart
                const componentData = {};
                filteredData.forEach(row => {
                    const component = row.COMP_NAME || 'Unknown';
                    if (!componentData[component]) {
                        componentData[component] = [];
                    }
                    componentData[component].push({
                        x: new Date(row.TIMESTAMP),
                        y: row[parameter]
                    });
                });
                
                // Prepare datasets for Chart.js
                const datasets = Object.keys(componentData).map((component, index) => {
                    // Sort data points by timestamp
                    const sortedData = componentData[component].sort((a, b) => a.x - b.x);
                    
                    return {
                        label: component,
                        data: sortedData,
                        borderColor: this.getChartColor(index),
                        backgroundColor: this.getChartColor(index, 0.1),
                        borderWidth: 2,
                        fill: false
                    };
                });
                
                // Create or update chart
                const ctx = document.getElementById('trend-chart').getContext('2d');
                if (this.state.charts.trendChart) {
                    this.state.charts.trendChart.data.datasets = datasets;
                    this.state.charts.trendChart.update();
                } else {
                    this.state.charts.trendChart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            datasets: datasets
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                x: {
                                    type: 'time',
                                    time: {
                                        unit: days <= 7 ? 'day' : 'week',
                                        displayFormats: {
                                            day: 'DD/MM/YYYY',
                                            week: 'DD/MM/YYYY'
                                        }
                                    },
                                    title: {
                                        display: true,
                                        text: 'Date'
                                    }
                                },
                                y: {
                                    title: {
                                        display: true,
                                        text: parameter
                                    }
                                }
                            }
                        }
                    });
                }
                
                // Update statistics
                this.updateTrendStatistics(filteredData, parameter);
            }
            
            // Update trend statistics
            updateTrendStatistics(data, parameter) {
                const values = data.map(row => row[parameter]).filter(val => !isNaN(val));
                
                if (values.length > 0) {
                    const sum = values.reduce((a, b) => a + b, 0);
                    const avg = sum / values.length;
                    const min = Math.min(...values);
                    const max = Math.max(...values);
                    
                    // Calculate standard deviation
                    const squareDiffs = values.map(value => Math.pow(value - avg, 2));
                    const avgSquareDiff = squareDiffs.reduce((a, b) => a + b, 0) / squareDiffs.length;
                    const stdDev = Math.sqrt(avgSquareDiff);
                    
                    // Update UI
                    document.getElementById('trend-average').textContent = avg.toFixed(2);
                    document.getElementById('trend-minimum').textContent = min.toFixed(2);
                    document.getElementById('trend-maximum').textContent = max.toFixed(2);
                    document.getElementById('trend-stddev').textContent = stdDev.toFixed(2);
                } else {
                    document.getElementById('trend-average').textContent = '-';
                    document.getElementById('trend-minimum').textContent = '-';
                    document.getElementById('trend-maximum').textContent = '-';
                    document.getElementById('trend-stddev').textContent = '-';
                }
            }
            
            // Update raw data table
            updateRawDataTable() {
                const vessel = document.getElementById('raw-vessel').value;
                const parameter = document.getElementById('raw-parameter').value;
                const days = parseInt(document.getElementById('raw-range').value);
                const searchText = document.getElementById('raw-search').value.toLowerCase();
                
                // Filter data based on selections
                let filteredData = this.state.rawData.filter(row => {
                    // Apply vessel filter
                    if (vessel && row.VESSEL !== vessel) return false;
                    
                    // Apply parameter filter
                    if (parameter && row[parameter] === undefined) return false;
                    
                    // Apply time range filter
                    if (days > 0) {
                        const cutoffDate = new Date();
                        cutoffDate.setDate(cutoffDate.getDate() - days);
                        if (new Date(row.TIMESTAMP) < cutoffDate) return false;
                    }
                    
                    // Apply search filter
                    if (searchText) {
                        const searchableFields = [
                            row.VESSEL,
                            row.EQUIPMENT_CODE,
                            row.COMP_NAME,
                            row.TIMESTAMP
                        ].join(' ').toLowerCase();
                        
                        if (!searchableFields.includes(searchText)) return false;
                    }
                    
                    return true;
                });
                
                // Sort by timestamp (newest first)
                filteredData.sort((a, b) => new Date(b.TIMESTAMP) - new Date(a.TIMESTAMP));
                
                // Update pagination
                this.state.currentPage = 1;
                this.state.filteredData = filteredData;
                this.renderRawDataTable();
            }
            
            // Render raw data table with pagination
            renderRawDataTable() {
                const tableBody = document.getElementById('raw-data-body');
                tableBody.innerHTML = '';
                
                // Calculate pagination
                const startIndex = (this.state.currentPage - 1) * this.state.rowsPerPage;
                const endIndex = Math.min(startIndex + this.state.rowsPerPage, this.state.filteredData.length);
                const pageData = this.state.filteredData.slice(startIndex, endIndex);
                
                // Update showing text
                document.getElementById('raw-data-showing').textContent = `${startIndex + 1}-${endIndex}`;
                document.getElementById('raw-data-total').textContent = this.state.filteredData.length;
                
                // Update pagination buttons
                document.getElementById('raw-prev-page').disabled = this.state.currentPage <= 1;
                document.getElementById('raw-next-page').disabled = endIndex >= this.state.filteredData.length;
                
                // Add rows to table
                if (pageData.length > 0) {
                    pageData.forEach(row => {
                        const parameter = document.getElementById('raw-parameter').value || 'Vel, Rms (RMS)';
                        const value = row[parameter];
                        
                        let status, statusClass;
                        if (parameter === 'Vel, Rms (RMS)') {
                            if (value > 7.1) {
                                status = 'Critical';
                                statusClass = 'status-critical';
                            } else if (value > 4.5) {
                                status = 'Warning';
                                statusClass = 'status-warning';
                            } else {
                                status = 'Normal';
                                statusClass = 'status-good';
                            }
                        } else {
                            status = 'Normal';
                            statusClass = 'status-good';
                        }
                        
                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td class="px-4 py-2">${this.formatDisplayTimestamp(row.TIMESTAMP)}</td>
                            <td class="px-4 py-2">${row.VESSEL}</td>
                            <td class="px-4 py-2">${row.EQUIPMENT_CODE}</td>
                            <td class="px-4 py-2">${row.COMP_NAME}</td>
                            <td class="px-4 py-2">${parameter}</td>
                            <td class="px-4 py-2">${value !== undefined ? value.toFixed(2) : '-'}</td>
                            <td class="px-4 py-2">
                                <span class="status-indicator ${statusClass}"></span>
                                ${status}
                            </td>
                        `;
                        tableBody.appendChild(tr);
                    });
                } else {
                    tableBody.innerHTML = `
                        <tr>
                            <td colspan="7" class="px-4 py-4 text-center text-gray-500">No data available</td>
                        </tr>
                    `;
                }
            }
            
            // Go to previous page
            prevPage() {
                if (this.state.currentPage > 1) {
                    this.state.currentPage--;
                    this.renderRawDataTable();
                }
            }
            
            // Go to next page
            nextPage() {
                const totalPages = Math.ceil(this.state.filteredData.length / this.state.rowsPerPage);
                if (this.state.currentPage < totalPages) {
                    this.state.currentPage++;
                    this.renderRawDataTable();
                }
            }
            
            // Identify equipment without recent readings
            identifyMissingEquipmentReadings() {
                // Get threshold in days
                const thresholdDays = parseInt(document.getElementById('missing-threshold').value);
                const vessel = document.getElementById('missing-vessel').value;
                
                // Find the latest date in the dataset
                const latestDate = new Date(Math.max(...this.state.rawData.map(row => new Date(row.TIMESTAMP).getTime())));
                
                // Calculate cutoff date
                const cutoffDate = new Date(latestDate);
                cutoffDate.setDate(cutoffDate.getDate() - thresholdDays);
                
                // Get all unique equipment codes
                const allEquipment = new Set();
                this.state.rawData.forEach(row => {
                    if (!vessel || row.VESSEL === vessel) {
                        if (row.EQUIPMENT_CODE) allEquipment.add(row.EQUIPMENT_CODE);
                    }
                });
                
                // Get equipment with recent readings
                const recentEquipment = new Set();
                this.state.rawData.forEach(row => {
                    if ((!vessel || row.VESSEL === vessel) && 
                        row.EQUIPMENT_CODE && 
                        new Date(row.TIMESTAMP) >= cutoffDate) {
                        recentEquipment.add(row.EQUIPMENT_CODE);
                    }
                });
                
                // Find missing equipment (those not in recentEquipment)
                const missingEquipment = Array.from(allEquipment).filter(equip => !recentEquipment.has(equip));
                
                // Get details for missing equipment
                const missingEquipmentDetails = missingEquipment.map(equip => {
                    // Find all records for this equipment
                    const equipmentRecords = this.state.rawData.filter(row => 
                        row.EQUIPMENT_CODE === equip && 
                        (!vessel || row.VESSEL === vessel)
                    );
                    
                    // Get the latest record
                    const latestRecord = equipmentRecords.reduce((latest, current) => {
                        const currentDate = new Date(current.TIMESTAMP);
                        const latestDate = latest ? new Date(latest.TIMESTAMP) : 0;
                        return currentDate > latestDate ? current : latest;
                    }, null);
                    
                    // Calculate days since last reading
                    const daysSince = latestRecord ? 
                        Math.floor((latestDate - new Date(latestRecord.TIMESTAMP)) / (1000 * 60 * 60 * 24)) : 
                        thresholdDays;
                    
                    // Get all components for this equipment
                    const components = [...new Set(equipmentRecords.map(row => row.COMP_NAME).filter(Boolean))];
                    
                    return {
                        equipmentCode: equip,
                        vessel: latestRecord ? latestRecord.VESSEL : vessel || 'Unknown',
                        components: components,
                        lastReading: latestRecord ? latestRecord.TIMESTAMP : null,
                        daysSinceLastReading: daysSince
                    };
                });
                
                // Sort based on selected sort option
                const sortOption = document.getElementById('missing-sort').value;
                missingEquipmentDetails.sort((a, b) => {
                    if (sortOption === 'days') {
                        return b.daysSinceLastReading - a.daysSinceLastReading;
                    } else if (sortOption === 'equipment') {
                        return a.equipmentCode.localeCompare(b.equipmentCode);
                    } else if (sortOption === 'component') {
                        const compA = a.components[0] || '';
                        const compB = b.components[0] || '';
                        return compA.localeCompare(compB);
                    }
                    return 0;
                });
                
                return {
                    latestDate: latestDate,
                    cutoffDate: cutoffDate,
                    totalEquipment: allEquipment.size,
                    recentEquipment: recentEquipment.size,
                    missingEquipment: missingEquipmentDetails
                };
            }
            
            // Refresh missing equipment data
            refreshMissingEquipmentData() {
                if (this.state.rawData.length === 0) {
                    return;
                }
                
                const missingData = this.identifyMissingEquipmentReadings();
                
                // Update summary
                document.getElementById('missing-summary').innerHTML = `
                    <div><strong>Latest data date:</strong> ${this.formatDisplayTimestamp(missingData.latestDate)}</div>
                    <div><strong>Cutoff date:</strong> ${this.formatDisplayTimestamp(missingData.cutoffDate)}</div>
                    <div><strong>Equipment missing readings:</strong> ${missingData.missingEquipment.length} out of ${missingData.totalEquipment} (${Math.round(missingData.missingEquipment.length / missingData.totalEquipment * 100)}%)</div>
                `;
                
                // Update equipment list
                const equipmentList = document.getElementById('missing-equipment-list');
                equipmentList.innerHTML = '';
                
                if (missingData.missingEquipment.length > 0) {
                    missingData.missingEquipment.forEach(equip => {
                        // Determine status
                        let status, statusClass;
                        if (equip.daysSinceLastReading > 90) {
                            status = 'Critical';
                            statusClass = 'status-critical';
                        } else if (equip.daysSinceLastReading > 60) {
                            status = 'Warning';
                            statusClass = 'status-warning';
                        } else {
                            status = 'Attention';
                            statusClass = 'status-warning';
                        }
                        
                        const tr = document.createElement('tr');
                        tr.innerHTML = `
                            <td class="px-4 py-2 font-medium">${equip.equipmentCode}</td>
                            <td class="px-4 py-2">${equip.components.join(', ')}</td>
                            <td class="px-4 py-2">${equip.vessel}</td>
                            <td class="px-4 py-2">${equip.lastReading ? this.formatDisplayTimestamp(equip.lastReading) : 'Never'}</td>
                            <td class="px-4 py-2">${equip.daysSinceLastReading}</td>
                            <td class="px-4 py-2">
                                <span class="status-indicator ${statusClass}"></span>
                                ${status}
                            </td>
                            <td class="px-4 py-2">
                                <button class="text-blue-600 hover:text-blue-800 mr-2" onclick="app.exportEquipmentDetails('${equip.equipmentCode}')">Export</button>
                                <button class="text-gray-600 hover:text-gray-800" onclick="app.notifyVessel('${equip.equipmentCode}')">Notify</button>
                            </td>
                        `;
                        equipmentList.appendChild(tr);
                    });
                } else {
                    equipmentList.innerHTML = `
                        <tr>
                            <td colspan="7" class="px-4 py-4 text-center text-gray-500">No equipment missing readings found</td>
                        </tr>
                    `;
                }
                
                // Update charts
                this.updateMissingEquipmentCharts(missingData);
            }
            
            // Update missing equipment charts
            updateMissingEquipmentCharts(missingData) {
                // Equipment status pie chart
                const statusCtx = document.getElementById('missing-equipment-chart').getContext('2d');
                
                const statusData = {
                    labels: ['With Recent Readings', 'Missing Readings'],
                    datasets: [{
                        data: [missingData.recentEquipment, missingData.missingEquipment.length],
                        backgroundColor: ['#10b981', '#ef4444'],
                        borderWidth: 1
                    }]
                };
                
                if (this.state.charts.missingEquipmentChart) {
                    this.state.charts.missingEquipmentChart.data = statusData;
                    this.state.charts.missingEquipmentChart.update();
                } else {
                    this.state.charts.missingEquipmentChart = new Chart(statusCtx, {
                        type: 'pie',
                        data: statusData,
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    });
                }
                
                // Days since reading histogram
                const daysCtx = document.getElementById('days-since-reading-chart').getContext('2d');
                
                // Group by days ranges
                const ranges = [
                    { label: '30-60 days', min: 30, max: 60, count: 0 },
                    { label: '61-90 days', min: 61, max: 90, count: 0 },
                    { label: '91-180 days', min: 91, max: 180, count: 0 },
                    { label: '181-365 days', min: 181, max: 365, count: 0 },
                    { label: '>365 days', min: 366, max: Infinity, count: 0 }
                ];
                
                missingData.missingEquipment.forEach(equip => {
                    const days = equip.daysSinceLastReading;
                    for (const range of ranges) {
                        if (days >= range.min && days <= range.max) {
                            range.count++;
                            break;
                        }
                    }
                });
                
                const daysData = {
                    labels: ranges.map(range => range.label),
                    datasets: [{
                        label: 'Equipment Count',
                        data: ranges.map(range => range.count),
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.7)',
                            'rgba(16, 185, 129, 0.7)',
                            'rgba(245, 158, 11, 0.7)',
                            'rgba(249, 115, 22, 0.7)',
                            'rgba(239, 68, 68, 0.7)'
                        ],
                        borderColor: [
                            'rgb(59, 130, 246)',
                            'rgb(16, 185, 129)',
                            'rgb(245, 158, 11)',
                            'rgb(249, 115, 22)',
                            'rgb(239, 68, 68)'
                        ],
                        borderWidth: 1
                    }]
                };
                
                if (this.state.charts.daysSinceReadingChart) {
                    this.state.charts.daysSinceReadingChart.data = daysData;
                    this.state.charts.daysSinceReadingChart.update();
                } else {
                    this.state.charts.daysSinceReadingChart = new Chart(daysCtx, {
                        type: 'bar',
                        data: daysData,
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        text: 'Number of Equipment'
                                    }
                                },
                                x: {
                                    title: {
                                        display: true,
                                        text: 'Days Since Last Reading'
                                    }
                                }
                            }
                        }
                    });
                }
            }
            
            // Export equipment data
            exportEquipmentData() {
                const vessel = document.getElementById('equipment-vessel').value;
                const equipment = document.getElementById('equipment-code').value;
                const component = document.getElementById('equipment-component').value;
                const parameter = document.getElementById('equipment-parameter').value;
                
                // Filter data based on selections
                let filteredData = this.state.rawData.filter(row => {
                    return (!vessel || row.VESSEL === vessel) &&
                           (!equipment || row.EQUIPMENT_CODE === equipment) &&
                           (!component || row.COMP_NAME === component);
                });
                
                // Generate filename
                let filename = 'equipment_data';
                if (vessel) filename += `_${vessel}`;
                if (equipment) filename += `_${equipment}`;
                if (component) filename += `_${component}`;
                filename += `_${parameter.replace(/[^a-zA-Z0-9]/g, '_')}`;
                filename += `_${this.formatDateForFilename(new Date())}.csv`;
                
                // Export data
                this.exportToCSV(filteredData, filename);
            }
            
            // Export trend data
            exportTrendData() {
                const vessel = document.getElementById('trend-vessel').value;
                const parameter = document.getElementById('trend-parameter').value;
                const days = parseInt(document.getElementById('trend-range').value);
                
                // Filter data based on selections
                let filteredData = this.state.rawData.filter(row => {
                    return (!vessel || row.VESSEL === vessel) && 
                           row[parameter] !== undefined;
                });
                
                // Apply time range filter
                if (days > 0) {
                    const cutoffDate = new Date();
                    cutoffDate.setDate(cutoffDate.getDate() - days);
                    
                    filteredData = filteredData.filter(row => {
                        return new Date(row.TIMESTAMP) >= cutoffDate;
                    });
                }
                
                // Generate filename
                let filename = 'trend_data';
                if (vessel) filename += `_${vessel}`;
                filename += `_${parameter.replace(/[^a-zA-Z0-9]/g, '_')}`;
                if (days > 0) filename += `_last${days}days`;
                filename += `_${this.formatDateForFilename(new Date())}.csv`;
                
                // Export data
                this.exportToCSV(filteredData, filename);
            }
            
            // Export raw data
            exportRawData() {
                const filteredData = this.state.filteredData;
                
                // Generate filename
                let filename = 'raw_data';
                const vessel = document.getElementById('raw-vessel').value;
                const parameter = document.getElementById('raw-parameter').value;
                const days = parseInt(document.getElementById('raw-range').value);
                
                if (vessel) filename += `_${vessel}`;
                if (parameter) filename += `_${parameter.replace(/[^a-zA-Z0-9]/g, '_')}`;
                if (days > 0) filename += `_last${days}days`;
                filename += `_${this.formatDateForFilename(new Date())}.csv`;
                
                // Export data
                this.exportToCSV(filteredData, filename);
            }
            
            // Export missing equipment report
            exportMissingEquipmentReport() {
                const missingData = this.identifyMissingEquipmentReadings();
                
                // Prepare CSV content
                let csvContent = "Equipment Code,Vessel,Components,Last Reading,Days Since,Status\n";
                
                missingData.missingEquipment.forEach(equip => {
                    // Determine status
                    let status;
                    if (equip.daysSinceLastReading > 90) {
                        status = 'Critical';
                    } else if (equip.daysSinceLastReading > 60) {
                        status = 'Warning';
                    } else {
                        status = 'Attention';
                    }
                    
                    csvContent += `"${equip.equipmentCode}","${equip.vessel}","${equip.components.join(', ')}","${equip.lastReading ? this.formatDisplayTimestamp(equip.lastReading) : 'Never'}","${equip.daysSinceLastReading}","${status}"\n`;
                });
                
                // Create download link
                const encodedUri = encodeURI("data:text/csv;charset=utf-8," + csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", `missing_equipment_report_${this.formatDateForFilename(new Date())}.csv`);
                document.body.appendChild(link);
                
                // Trigger download
                link.click();
                document.body.removeChild(link);
                
                this.showToast("Missing equipment report exported successfully");
            }
            
            // Export equipment details
            exportEquipmentDetails(equipmentCode) {
                // Filter data for the specific equipment
                const vessel = document.getElementById('missing-vessel').value;
                const filteredData = this.state.rawData.filter(row => 
                    row.EQUIPMENT_CODE === equipmentCode && 
                    (!vessel || row.VESSEL === vessel)
                );
                
                // Generate filename
                const filename = `equipment_details_${equipmentCode}_${this.formatDateForFilename(new Date())}.csv`;
                
                // Export data
                this.exportToCSV(filteredData, filename);
            }
            
            // Export data to CSV
            exportToCSV(data, filename) {
                if (data.length === 0) {
                    this.showToast("No data to export", "warning");
                    return;
                }
                
                // Get all unique column names
                const columns = new Set();
                data.forEach(row => {
                    Object.keys(row).forEach(key => columns.add(key));
                });
                
                // Prepare header row
                const header = Array.from(columns).join(',') + '\n';
                
                // Prepare data rows
                let csvContent = header;
                data.forEach(row => {
                    const rowData = Array.from(columns).map(col => {
                        let value = row[col];
                        
                        // Format dates
                        if (col === 'TIMESTAMP' && value) {
                            return `"${this.formatDisplayTimestamp(value)}"`;
                        }
                        
                        // Handle other values
                        if (value === undefined || value === null) return '';
                        if (typeof value === 'string') return `"${value}"`;
                        return value;
                    }).join(',');
                    
                    csvContent += rowData + '\n';
                });
                
                // Create download link
                const encodedUri = encodeURI("data:text/csv;charset=utf-8," + csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", filename);
                document.body.appendChild(link);
                
                // Trigger download
                link.click();
                document.body.removeChild(link);
                
                this.showToast(`Data exported to ${filename}`);
            }
            
            // Notify vessel (placeholder function)
            notifyVessel(equipmentCode) {
                // In a real application, this would send a notification to the vessel
                this.showToast(`Notification sent for equipment ${equipmentCode}`);
            }
            
            // Format date for filenames
            formatDateForFilename(date) {
                return date.toISOString().split('T')[0].replace(/-/g, '');
            }
            
            // Helper function to get chart colors
            getChartColor(index, alpha = 1) {
                const colors = [
                    `rgba(59, 130, 246, ${alpha})`,   // Blue
                    `rgba(16, 185, 129, ${alpha})`,   // Green
                    `rgba(245, 158, 11, ${alpha})`,   // Yellow
                    `rgba(239, 68, 68, ${alpha})`,    // Red
                    `rgba(139, 92, 246, ${alpha})`,   // Purple
                    `rgba(236, 72, 153, ${alpha})`,   // Pink
                    `rgba(20, 184, 166, ${alpha})`,   // Teal
                    `rgba(249, 115, 22, ${alpha})`,   // Orange
                    `rgba(6, 182, 212, ${alpha})`,    // Cyan
                    `rgba(168, 85, 247, ${alpha})`    // Violet
                ];
                
                return colors[index % colors.length];
            }
            
            // Show toast notification
            showToast(message, type = 'success') {
                this.toastMessage.textContent = message;
                
                // Set color based on type
                if (type === 'success') {
                    this.toast.className = 'bg-green-500 text-white px-6 py-3 rounded shadow-lg';
                } else if (type === 'error') {
                    this.toast.className = 'bg-red-500 text-white px-6 py-3 rounded shadow-lg';
                } else if (type === 'warning') {
                    this.toast.className = 'bg-yellow-500 text-white px-6 py-3 rounded shadow-lg';
                }
                
                // Show toast
                this.toast.classList.add('show');
                
                // Hide after 3 seconds
                setTimeout(() => {
                    this.toast.classList.remove('show');
                }, 3000);
            }
        }

        // Initialize app when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            window.app = new VibrationAnalysisApp();
        });
    </script>
</body>
</html>
